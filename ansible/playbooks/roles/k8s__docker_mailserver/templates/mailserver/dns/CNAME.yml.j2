apiVersion: externaldns.k8s.io/v1alpha1
kind: DNSEndpoint
metadata:
  name: CNAME
  namespace: "{{ docker_mailserver__namespace }}"
spec:
  endpoints:
    - dnsName: smtp.{{ iac__root_domain }}
      recordTTL: 1                # 1 is the "Auto" TTL value for Cloudflare
      recordType: CNAME
      targets:
        - "{{ iac__root_domain }}"
      providerSpecific:
        - name: cloudflare-proxied
          value: "false"  # Disable proxying
    - dnsName: imap.{{ iac__root_domain }}
      recordTTL: 1                # 1 is the "Auto" TTL value for Cloudflare
      recordType: CNAME
      targets:
        - "{{ iac__root_domain }}"
      providerSpecific:
        - name: cloudflare-proxied
          value: "false"  # Disable proxying
    - dnsName: autodiscover.{{ iac__root_domain }}
      recordTTL: 1                # 1 is the "Auto" TTL value for Cloudflare
      recordType: CNAME
      targets:
        - "{{ iac__root_domain }}"
      providerSpecific:
        - name: cloudflare-proxied
          value: "false"  # Disable proxying